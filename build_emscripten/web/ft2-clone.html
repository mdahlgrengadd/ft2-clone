<!doctypehtml><html lang=en><head><meta charset=utf-8><title>FastTracker II Clone</title><style>body,html{height:100%;margin:0;background:#000;display:flex;align-items:center;justify-content:center}#canvas{image-rendering:pixelated;image-rendering:-moz-crisp-edges;image-rendering:crisp-edges}body,html{overflow:hidden;touch-action:none}#canvas{touch-action:none}</style></head><body><canvas height=400 id=canvas width=632></canvas><script>!function(){const e=EventTarget.prototype.addEventListener,o=["touchstart","touchmove","wheel","mousewheel"];EventTarget.prototype.addEventListener=function(n,t,r){return o.includes(n)&&(r="boolean"==typeof r?{capture:r,passive:!0}:"object"==typeof r&&null!==r?{...r,passive:!0}:{passive:!0}),e.call(this,n,t,r)}}();const canvas=document.getElementById("canvas");var persistentStorageReady=!1,originalMain=null,Module={canvas:canvas,lastMouseEvent:null,setStatus:function(){},monitorRunDependencies:function(){},print:function(e){console.log(e)},printErr:function(e){console.error(e)},postRun:[],noInitialRun:!0,onRuntimeInitialized:function(){console.log("Runtime initialized, setting up persistent storage..."),initPersistentStorage()},preRun:[]};function initPersistentStorage(){console.log("Initializing persistent storage...");try{FS.mkdir("/persistent"),FS.mkdir("/persistent/modules"),FS.mkdir("/persistent/samples"),FS.mkdir("/persistent/instruments"),FS.mkdir("/persistent/config"),FS.mount(IDBFS,{},"/persistent");try{FS.mkdir("/home"),FS.symlink("/persistent","/home/web_user"),console.log("Created /home/web_user symlink to /persistent")}catch(e){console.log("Note: /home/web_user symlink creation failed (may already exist)")}console.log("Syncing persistent storage from IndexedDB..."),FS.syncfs(!0,(function(e){e?console.log("Error loading persistent data:",e):console.log("Persistent storage loaded successfully"),persistentStorageReady=!0,console.log("Persistent storage initialization complete - starting main application");try{"function"==typeof Module.callMain?Module.callMain():"function"==typeof Module._main?Module._main():"function"==typeof Module.ccall?Module.ccall("main","number",[],[]):console.error("No suitable main function found")}catch(e){console.log("Error calling main:",e);try{Module._main?Module._main():Module.asm&&Module.asm._main&&Module.asm._main()}catch(e){console.error("All main function calls failed:",e)}}}))}catch(e){console.error("Error initializing persistent storage:",e),persistentStorageReady=!0;try{"function"==typeof Module.callMain?Module.callMain():"function"==typeof Module._main?Module._main():"function"==typeof Module.ccall&&Module.ccall("main","number",[],[])}catch(e){if(console.error("Failed to start app after storage error:",e),Module._main)try{Module._main()}catch(e){console.error("Final fallback failed:",e)}}}}function storeEvt(e){Module&&(Module.lastMouseEvent=e)}function setupDragAndDrop(e){const o=["xm","ft","nst","stk","mod","s3m","stm","fst","digi","bem","it"];function n(e){e.preventDefault(),e.stopPropagation()}function t(o){e.style.border="3px dashed #4CAF50",e.style.backgroundColor="rgba(76, 175, 80, 0.1)"}function r(o){e.style.border="",e.style.backgroundColor=""}function s(n){const t=n.name.toLowerCase().split(".").pop();if(!o.includes(t))return console.log(`Unsupported file type: ${t}. Supported: ${o.join(", ")}`),void alert(`Unsupported file type: ${t}\nSupported formats: ${o.join(", ")}`);console.log(`Uploading module file: ${n.name}`),e.style.border="3px solid #2196F3",e.style.backgroundColor="rgba(33, 150, 243, 0.1)";const r=new FileReader;r.onload=function(o){const t=o.target.result,r=new Uint8Array(t);try{const o=`/home/web_user/modules/${n.name}`;FS.writeFile(o,r),console.log(`File uploaded to VFS: ${o}`),FS.syncfs(!1,(function(e){e?console.log("Error syncing uploaded file:",e):console.log("File synced to persistent storage")})),function(){try{Module._refreshModuleDirectory?(Module._refreshModuleDirectory(),console.log("Called FT2 directory refresh")):(console.log("FT2 refresh function not yet available"),setTimeout((function(){Module._refreshModuleDirectory&&(Module._refreshModuleDirectory(),console.log("Called FT2 directory refresh (delayed)"))}),100))}catch(e){console.log("Could not trigger FT2 directory refresh:",e)}}(),e.style.border="3px solid #4CAF50",e.style.backgroundColor="rgba(76, 175, 80, 0.2)",console.log(`Successfully uploaded: ${n.name}`),setTimeout((function(){e.style.border="",e.style.backgroundColor=""}),2e3)}catch(o){console.error("Error uploading file:",o),e.style.border="3px solid #f44336",e.style.backgroundColor="rgba(244, 67, 54, 0.1)",alert(`Error uploading file: ${o.message}`),setTimeout((function(){e.style.border="",e.style.backgroundColor=""}),3e3)}},r.readAsArrayBuffer(n)}["dragenter","dragover","dragleave","drop"].forEach((o=>{e.addEventListener(o,n,!1),document.body.addEventListener(o,n,!1)})),["dragenter","dragover"].forEach((o=>{e.addEventListener(o,t,!1)})),["dragleave","drop"].forEach((o=>{e.addEventListener(o,r,!1)})),e.addEventListener("drop",(function(e){const o=e.dataTransfer;!function(e){for(let o=0;o<e.length;o++)s(e[o])}(o.files)}),!1)}Module.postRun=[function(){console.log("FastTracker II Clone post-run"),setInterval((function(){"undefined"!=typeof FS&&FS.syncfs&&FS.syncfs(!1,(function(e){e||console.log("Periodic sync completed")}))}),3e4),window.addEventListener("beforeunload",(function(){"undefined"!=typeof FS&&FS.syncfs&&FS.syncfs(!1,(function(e){console.log("Final sync on page unload",e?"failed":"completed")}))}))}],canvas&&(["mousemove","mousedown","mouseup","click"].forEach((e=>{canvas.addEventListener(e,storeEvt)})),canvas.addEventListener("click",(()=>canvas.focus())),setupDragAndDrop(canvas)),document.addEventListener("mousemove",storeEvt)</script><script async src=ft2-clone.js></script></body></html>